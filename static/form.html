<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>FLL Scoring</title>
    <script type="text/javascript">

        function total_score() {
            var score = 0;
            var mission0 = document.getElementById('M00a') ;
            if (mission0.checked) score += 20;
            var mission1 = document.getElementById('M01a');
            if (mission1.checked) score += 10;
            var mission2a = document.getElementById('M02a');
            score += Number(mission2a.innerText) * 5;
            var mission2b = document.getElementById('M02b');
            if (mission2b.checked) score += 10;
            var mission3a = document.getElementById('M03a');
            score += Number(mission3a.innerText) * 10;
            var mission3b = document.getElementById('M03b');
            if (mission3b.checked) score += 5;
            var mission4a = document.getElementById('M04a');
            score += Number(mission4a.innerText) * 5;
            var mission4b = document.getElementById('M04b');
            if (mission4b.checked) score += 5;
            var mission5a = document.getElementById('M05a');
            if (mission5a.checked) score += 20;
            var mission5b = document.getElementById('M05b');
            if (mission5b.checked) score += 10;
            var mission6a = document.getElementById('M06a');
            if (mission6a.checked) score += 10;
            var mission6b = document.getElementById('M06b');
            if (mission6b.checked) score += 10;
            var mission7a = document.getElementById('M07a');
            score += Number(mission7a.innerText) * 10;
            var mission8a = document.getElementById('M08a');
            if (mission8a.checked) score += 10;
            var mission8b = document.getElementById('M08b');
            if (mission8b.checked) score += 10;
            var mission9a = document.getElementById('M09a');
            if (mission9a.checked) score += 10;
            var mission9b = document.getElementById('M09b');
            score += Number(mission9b.value);
            var mission10a = document.getElementById('M10a');
            score += Number(mission10a.innerText) * 5;
            var mission10b = document.getElementById('M10b');
            if (mission10b.checked) score += 10;
            var mission11a = document.getElementById('M11a');
            if (mission11a.checked) score += 20;
            var mission12a = document.getElementById('M12a');
            score += Number(mission12a.innerText) * 5;
            var mission12b = document.getElementById('M12b');
            score += Number(mission12b.innerText) * 10;
            var mission13 = document.getElementById('M13a');
            score += Number(mission13.innerText) * 5;
            var mission14a = document.getElementById('M14a');
            score += Number(mission14a.innerText) * 5;
            var mission14b = document.getElementById('M14b');
            if (mission14b.checked) score += 10;
            var mission15a = document.getElementById('M15a');
            score += Number(mission15a.innerText) * 5;
            var missionPT = document.getElementById('PrecisionTokens');
            var scorelookup = {0:0, 1:10, 2:15, 3:25, 4:35, 5:50, 6:50}
            score += scorelookup[missionPT.value];
            document.getElementById('TotalPoints').value = score;
            var total_score = score;
            console.log(total_score);
        }

        function minus(mission){
            var element = document.getElementById(mission);
            var value = Number(element.innerText) - 1;
            if (value < 0) value = 0;
            element.innerText = value;
            total_score();
        }
        
        function plus(mission){
            var element = document.getElementById(mission);
            var value = Number(element.innerText) + 1;
            if (value > 3 && mission == 'M02a') value = 3;
            if (value > 3 && mission == 'M03a') value = 3;
            if (value > 3 && mission == 'M04a') value = 3;
            if (value > 3 && mission == 'M07a') value = 3;
            if (value > 3 && mission == 'M10a') value = 3;
            if (value > 3 && mission == 'M12a') value = 3;
            if (value > 3 && mission == 'M12b') value = 3;
            if (value > 3 && mission == 'M13a') value = 3;
            if (value > 3 && mission == 'M14a') value = 3;
            if (value > 3 && mission == 'M15a') value = 3;
            element.innerText = value;
            total_score();
        }

        function startMatch(){
            var selection_screen = document.getElementsByClassName("selection-screen")[0];
            selection_screen.hidden = true;
            var scoring_screen = document.getElementsByClassName("scoring-screen")[0];
            scoring_screen.hidden = false;
        }

        function submitMatch(){
            const http = new XMLHttpRequest();
            const form = new FormData();

            form.append("team", document.getElementById('name').value);
            form.append("match", document.getElementById('match').value);
            form.append("referee", document.getElementById('referee').value);
            form.append("table", document.getElementById('table').value);
            form.append("score", document.getElementById('TotalPoints').value);
            form.append("GPScore", document.getElementById('GP').value);
            form.append("teamInitials", document.getElementById('TeamInitials').value);
            form.append("precisionTokens", document.getElementById('PrecisionTokens').value);


            http.open("POST", "/saveMatch");
            http.send(form);
            
            var scoring_screen = document.getElementsByClassName("scoring-screen")[0];
            scoring_screen.hidden = true;
            var selection_screen = document.getElementsByClassName("selection-screen")[0];
            selection_screen.hidden = false;  
            
            var m02a = document.getElementById('M02a');
            var m03a = document.getElementById('M03a');
            var m04a = document.getElementById('M04a');
            var m07a = document.getElementById('M07a');
            var m09b = document.getElementById('M09b');
            var m10a = document.getElementById('M10a');
            var m12a = document.getElementById('M12a');
            var m12b = document.getElementById('M12b');
            var m13a = document.getElementById('M13a');
            var m14a = document.getElementById('M14a');
            var m15a = document.getElementById('M15a');
           

            document.getElementById("name").value = "";
            document.getElementById("match").value = "";
            document.getElementById("referee").value = "";
            document.getElementById("table").value = "";
            document.getElementById("M00a").checked = false;
            document.getElementById("M01a").checked = false;
            m02a.innerText = "0";
            document.getElementById("M02b").checked = false;
            m03a.innerText = "0";
            document.getElementById("M03b").checked = false;
            m04a.innerText = "0";
            document.getElementById("M04b").checked = false;
            document.getElementById("M05a").checked = false; 
            document.getElementById("M05b").checked = false; 
            document.getElementById("M06a").checked = false; 
            document.getElementById("M06b").checked = false; 
            m07a.innerText = "0";
            document.getElementById("M08a").checked = false; 
            document.getElementById("M08b").checked = false; 
            document.getElementById("M09a").checked = false; 
            document.getElementById("M09b").value = "";
            m10a.innerText = "0";
            document.getElementById("M10b").checked = false;
            document.getElementById("M11a").checked = false;
            m12a.innerText = "0";
            m12b.innerText = "0";
            m13a.innerText = "0";
            m14a.innerText = "0";
            document.getElementById("M14b").checked = false; 
            m15a.innerText = "0";
            document.getElementById("PrecisionTokens").value = "";
            document.getElementById("name").value = "";
            document.getElementById("TotalPoints").value = "0";
            document.getElementById("TeamInitials").value = "";
        }
        
    </script>

    <style>
        body {
            font-family: 'Georgia';
        }

        div.selection-screen {
            line-height: 175%;
            text-align: center;

            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }

        p {
            font-weight: bold;
            font-size: 23px;
        }

        div.scoring-screen th {
            text-align: left;
        }

        div.scoring-screen td {
            text-align: left;
        }

        div.scoring-screen input[type="checkbox"] {
            width: 40px;
            height: 40px;
        }

        table, tr {
            background-color: hsl(180, 41%, 89%);
            border: 2px solid;
            border-collapse: collapse;
        }

        th {
            height: 40px;
        } 

    </style>
</head>
<body>

    <!-- Selection screen -->
    <div class="selection-screen">
        <p>FLL SUPERPOWERED Scoring</p>
        <form>
                Team Number: <input type="number" id="name"/><br />
                Match Number: <input type="number" id="match" min="0"/><br />
                Referee: <input type="text" id="referee"/><br />
                Table Number: <input type="number" id="table" min="0"/><br />
                <input type="button" value="Done" style="height:40px;width:100px" onclick="javascript:startMatch()"/>
        </form>
    </div>

    <!-- Scoring screen -->
    <div hidden class="scoring-screen">
        <p>FLL SUPERPOWERED SCORING APP</p>
        <table>
            <tbody>
                
                <tr>
                     <body style="background-color:rgb(238, 245, 179);"></body>
                    <th>Mission 0 Equipment Inspection</th>
                    </body>
                </tr>
                <tr>
                    <td>If your robot and all your equipment fit completely in one launch area and are under a height of 12 in.</td>
                    <td><input type="checkbox" id="M00a" onchange="total_score();"/></td>
                </tr>
                
                <tr>
                    <th>Mission 1 Innovation Project Model</th>
                </tr>
                <tr>
                    <td>If model is completely in or partially in hydrogen plant</td>
                    <td><input type="checkbox" id="M01a" onchange="total_score();"/></td>
                </tr>
                
                <tr>
                    <th>Mission 2 Oil Platform</th>
                </tr>
                <tr>
                    <td>If a fuel unit is in the fuel truck</td>
                    <td><input type="button" value="-" onclick="minus('M02a')"></input>
                        <span id="M02a">0</span> 
                        <input type="button" value="+" onclick = "plus('M02a')"></input>
                    </td>
                </tr>
                <tr>
                    <td> Bonus: If at least one fuel unit is in the fuel truck and the fuel truck is at least partly over the fueling station target:</td>
                    <td><input type="checkbox" id="M02b" onchange="total_score();"/></td>
                </tr>

                <tr>
                    <th>Mission 3 Energy Storage</th>
                </tr>
                <tr>
                    <td>If an energy unit is completely in the energy storage bin (max of three):</td>
                    <td><input type="button" value="-" onclick="minus('M03a')"></input>
                        <span id="M03a">0</span> 
                        <input type="button" value="+" onclick = "plus('M03a')"></input></td>
                </tr>
                <tr>
                    <td>If the energy unit is completely removed from the energy storage tray:</td>
                    <td><input type="checkbox" id="M03b" onchange="total_score();"/></td>
                </tr>

                <tr>
                    <th>Mission 4 Solar Farm</th>
                </tr>
                <tr>
                    <td>If an energy unit has been completely removed from its starting circle:</td>
                    <td><input type="button" value="-" onclick="minus('M04a')"></input>
                        <span id="M04a">0</span> 
                        <input type="button" value="+" onclick = "plus('M04a')"></input></td>
                </tr>
                <tr>
                    <td>Bonus: If all three energy units have been completely removed from their starting circles:</td>
                    <td><input type="checkbox" id="M04b" onchange="total_score();"/></td>
                </tr>

                <tr>
                    <th>Mission 5 Smart Grid</th>
                </tr>
                <tr>
                    <td>If your field's orange connector is completely raised:</td>
                    <td><input type="checkbox" id="M05a" onchange="total_score();"/></td>
                </tr>
                <tr>
                    <td>Bonus: If both teams' orange connectors are completely raised:</td>
                    <td><input type="checkbox" id="M05b" onchange="total_score();"/></td>
                </tr>

                <tr>
                    <th>Mission 6 Hybrid Car</th>
                </tr>
                <tr>
                    <td>If the hybrid car is no longer touching the ramp:</td>
                    <td><input type="checkbox" id="M06a" onchange="total_score();"/></td>
                </tr>
                <tr>
                    <td>If the hybrid unit is in the hybrid car:</td>
                    <td><input type="checkbox" id="M06b" onchange="total_score();"/></td>
                </tr>

                <tr>
                    <th>Mission 7 Wind Turbine</th>
                </tr>
                <tr>
                    <td>If an energy unit is no longer touching the wind turbine:</td>
                    <td><input type="button" value="-" onclick="minus('M07a')"></input>
                        <span id="M07a">0</span> 
                        <input type="button" value="+" onclick = "plus('M07a')"></input></td>
                </tr>

                <tr>
                    <th>Mission 8 Watch Television</th>
                </tr>
                <tr>
                    <td>If the television is completely raised:</td>
                    <td><input type="checkbox" id="M08a" onchange="total_score();"/></td>
                </tr>
                <tr>
                    <td>If an energy unit is completely in the green television slot:</td>
                    <td><input type="checkbox" id="M08b" onchange="total_score();"/></td>
                </tr>

                <tr>
                    <th>Mission 9 Dinosaur Toy</th>
                </tr>
                <tr>
                    <td>If the dinosaur toy is completely in the left home area:</td>
                    <td><input type="checkbox" id="M09a" onchange="total_score();"/></td>
                </tr>
                <tr>
                    <td>If the dinosaur toy lid if completely closed:</td>
                </tr>
                <tr>
                    <td>-And there is an energy unit inside or there is a rechargeable battery inside:
                    </td>
                    <td>
                        <label for="M09b"></label>
                        <select id="M09b" name="M09b" onchange="total_score();">
                            <option value="">--Choose an Option--</option>
                            <option value="10">Empty</option>
                            <option value="10">Energy Unit</option>
                            <option value="20">Rechargeable battery</option>
                        </select>
                    </td>
                </tr>

                <tr>
                    <th>Mission 10 Power Plant</th>
                </tr>
                <tr>
                    <td>If an energy unit is no longer touching the power plant:</td>
                    <td><input type="button" value="-" onclick="minus('M10a')"></input>
                        <span id="M10a">0</span> 
                        <input type="button" value="+" onclick = "plus('M10a')"></input></td>
                </tr>
                <tr>
                    <td>Bonus: If all three energy units are no longer touching the power plant:</td>
                    <td><input type="checkbox" id="M10b" onchange="total_score();"/></td>
                </tr>

                <tr>
                    <th>Mission 11 Hydroelectric Dam</th>
                </tr>
                <tr>
                    <td>If the energy unit is no longer touching the hydroelectric dam:</td>
                    <td><input type="checkbox" id="M11a" onchange="total_score();"/></td>
                </tr>

                <tr>
                    <th>Mission 12 Water Reservoir</th>
                </tr>
                <tr>
                    <td>If a looped water unit is completely in the water reservoir, touching the mat:</td>
                    <td><input type="button" value="-" onclick="minus('M12a')"></input>
                        <span id="M12a">0</span> 
                        <input type="button" value="+" onclick = "plus('M12a')"></input></td>
                </tr>
                <tr>
                    <td>If a looped water unit is placed on a single red hook:</td>
                    <td><input type="button" value="-" onclick="minus('M12b')"></input>
                        <span id="M12b">0</span> 
                        <input type="button" value="+" onclick = "plus('M12b')"></input></td>
                </tr>

                <tr>
                    <th>Mission 13 Power-To-X</th>
                </tr>
                <tr>
                    <td>If an energy unit is completely in the hydrogen plant target area (Max of Three):</td>
                    <td><input type="button" value="-" onclick="minus('M13a')"></input>
                        <span id="M13a">0</span> 
                        <input type="button" value="+" onclick = "plus('M13a')"></input></td>
                </tr>

                <tr>
                    <th>Mission 14 Toy Factory</th>
                </tr>
                <tr>
                    <td>If an energy unit is at least partly in the slot in the back of the toy factory (or in the red hopper) (Max of three):</td>
                    <td><input type="button" value="-" onclick="minus('M14a')"></input>
                        <span id="M14a">0</span> 
                        <input type="button" value="+" onclick = "plus('M14a')"></input></td>
                </tr>
                <tr>
                    <td>If the mini dinosaur toy has been released:</td>
                    <td><input type="checkbox" id="M14b" onchange="total_score();"/></td>
                </tr>
                
                <tr>
                    <th>Mission 15 Rechargeable Battery</th>
                </tr>
                <tr>
                    <td>If an energy unit is completely in the rechargeable battery target area (Max of 3):</td>
                    <td><input type="button" value="-" onclick="minus('M15a')"></input>
                        <span id="M15a">0</span> 
                        <input type="button" value="+" onclick = "plus('M15a')"></input></td>
                </tr>

                <tr>
                    <th>Precision Tokens</th>
                </tr>
                <tr>
                    <td>Remaining tokens at the end of the match</td>
                    <td>
                        <label for="PrecisionTokens"></label>
                        <select id="PrecisionTokens" name="PrecisionTokens" onchange="total_score();">
                            <option value="">--Choose an Option--</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                        </select>
                    </td>
                </tr>
                
                <tr>
                    <th>Gracious Professionalism</th>
                </tr>
                <tr>
                    <td>Level of Gracious Professionalism displayed at the robot game table</td>
                    <td>
                        <label for="GP"></label>
                        <select id="GP" name="GP">
                            <option value="">--Choose an Option--</option>
                            <option value="2">Developing</option>
                            <option value="3">Accomplished</option>
                            <option value="4">Exceeds</option>
                        </select>
                    </td>
                </tr>

                <tr>
                    <th>Team Initials</th>
                    <td><input type="text" id="TeamInitials"/></td>
                </tr>

                <tr>
                    <th>Total Points</th>
                    <td><input type="number" id="TotalPoints" value="0" readonly/></td>
                </tr>
                <tr>
                    <td><input type="button" value="Submit" style="height:40px;width:100px" onchange="total_score();" onclick="submitMatch();"/><td>
                </tr>

            </tbody>
        </table>

        <!-- <form>
             Mission 0 Equipment Inspection: <input type="checkbox" id="M00"/><br />
             Mission 1 Innovation Project Model: <input type="checkbox" id="M01"/><br />
             Mission 2 Oil Platform: <input type="checkbox" id="M02"/><br />
             Mission 2 Bonus: <input type="checkbox" id="M02b"/><br />
             Mission 3 Energy Storage: 
                Energy unit completely in energy storage bin: <input type="number" id="M03"/><br />
                Energy unit completely removed: <input type="checkbox" id="M03b"/><br />
             Mission 4 Solar Farm: <input type="checkbox" id="M04"/><br />
             Mission 5 Smart Grid: <input type="checkbox" id="M05"/><br />
             Mission 6 Hybrid Car: <input type="checkbox" id="M06"/><br />
             Mission 7 Wind Turbine: <input type="checkbox" id="M07"/><br />
             Mission 8 Watch Television: <input type="checkbox" id="M08"/><br />
             Mission 9 Dinosaur Toy: <input type="checkbox" id="M09"/><br />
             Mission 10 Power Plant: <input type="checkbox" id="M10"/><br />
             Mission 11 Hydroelectric Dam: <input type="checkbox" id="M11"/><br />
             Mission 12 Water Reservoir: <input type="checkbox" id="M12"/><br />
             Mission 13 Power-To-X: <input type="checkbox" id="M13"/><br />
             Mission 14 Toy Factory: <input type="checkbox" id="M14"/><br />
             Mission 15 Rechargable Battery: <input type="checkbox" id="M15"/><br />
        </form> -->
    </div>
</body>
</html>